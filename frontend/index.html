<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Washing Center - Billing Management</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --dark-bg: #1e293b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f1f5f9;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), #1e40af);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
        }

        .page-section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .page-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color), #3b82f6);
            color: white;
            border-radius: 12px 12px 0 0 !important;
            font-weight: 600;
        }

        .service-item {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .service-item:hover {
            border-color: var(--primary-color);
            background-color: #f8fafc;
        }

        .service-item input[type="checkbox"]:checked + label {
            color: var(--primary-color);
            font-weight: 600;
        }

        .btn-primary {
            background: var(--primary-color);
            border: none;
            padding: 10px 24px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #1e40af;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .invoice-preview {
            background: white;
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }

        .table-responsive {
            border-radius: 8px;
            overflow: hidden;
        }

        .employee-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
        }

        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.1rem;
            }
            
            .stat-card {
                margin-bottom: 15px;
            }
        }

        .badge-custom {
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><i class="fas fa-car-wash me-2"></i>WashCenter Pro</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showPage('dashboard')">
                            <i class="fas fa-chart-line me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('newbill')">
                            <i class="fas fa-file-invoice me-1"></i>New Bill
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('reports')">
                            <i class="fas fa-chart-bar me-1"></i>Reports
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('employees')">
                            <i class="fas fa-users me-1"></i>Employees
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page-section active">
            <div class="row">
                <div class="col-12">
                    <h2 class="mb-4"><i class="fas fa-chart-line me-2"></i>Dashboard</h2>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-3 col-sm-6">
                    <div class="stat-card">
                        <div class="stat-icon bg-primary bg-opacity-10 text-primary">
                            <i class="fas fa-car"></i>
                        </div>
                        <h3 id="totalVehicles" class="mb-1">0</h3>
                        <p class="text-muted mb-0">Total Vehicles Today</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stat-card">
                        <div class="stat-icon bg-success bg-opacity-10 text-success">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h3 id="totalEarnings" class="mb-1">₹0</h3>
                        <p class="text-muted mb-0">Total Earnings</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stat-card">
                        <div class="stat-icon bg-warning bg-opacity-10 text-warning">
                            <i class="fas fa-spray-can"></i>
                        </div>
                        <h3 id="totalServices" class="mb-1">0</h3>
                        <p class="text-muted mb-0">Services Done</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stat-card">
                        <div class="stat-icon bg-info bg-opacity-10 text-info">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <h3 id="activeEmployees" class="mb-1">0</h3>
                        <p class="text-muted mb-0">Active Employees</p>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-chart-bar me-2"></i>Service-wise Count Today
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Service</th>
                                            <th>Count</th>
                                            <th>Revenue</th>
                                        </tr>
                                    </thead>
                                    <tbody id="serviceStatsTable">
                                        <tr>
                                            <td colspan="3" class="text-center text-muted">No data available</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-clock me-2"></i>Recent Activities
                        </div>
                        <div class="card-body">
                            <div id="recentActivities">
                                <p class="text-muted">No recent activities</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- New Bill Page -->
        <div id="newbill" class="page-section">
            <div class="row">
                <div class="col-12">
                    <h2 class="mb-4"><i class="fas fa-file-invoice me-2"></i>Create New Bill</h2>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-7">
                    <!-- Car Search -->
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-search me-2"></i>Vehicle Search
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <input type="text" id="vehicleNumber" class="form-control" placeholder="Enter Vehicle Number (e.g., KA01AB1234)" style="text-transform: uppercase;">
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-primary w-100" onclick="searchVehicle()">
                                        <i class="fas fa-search me-2"></i>Search
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Form -->
                    <div class="card mt-3">
                        <div class="card-header">
                            <i class="fas fa-user me-2"></i>Customer Information
                        </div>
                        <div class="card-body">
                            <form id="customerForm">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Customer Name</label>
                                        <input type="text" id="customerName" class="form-control" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Mobile Number</label>
                                        <input type="tel" id="mobileNumber" class="form-control" pattern="[0-9]{10}" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Vehicle Number</label>
                                        <input type="text" id="vehicleNumberDisplay" class="form-control" readonly style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Vehicle Type</label>
                                        <select id="vehicleType" class="form-select" required>
                                            <option value="">Select Type</option>
                                            <option value="Car">Car</option>
                                            <option value="SUV">SUV</option>
                                            <option value="Bike">Bike</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Service Selection -->
                    <div class="card mt-3">
                        <div class="card-header">
                            <i class="fas fa-list-check me-2"></i>Select Services
                        </div>
                        <div class="card-body">
                            <div id="servicesList"></div>
                            
                            <hr>
                            <h6 class="mb-3">Add Custom Service</h6>
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <input type="text" id="customServiceName" class="form-control" placeholder="Service Name">
                                </div>
                                <div class="col-md-4">
                                    <input type="number" id="customServicePrice" class="form-control" placeholder="Price">
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-success w-100" onclick="addCustomService()">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-5">
                    <!-- Invoice Preview -->
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-file-invoice-dollar me-2"></i>Bill Preview
                        </div>
                        <div class="card-body">
                            <div class="invoice-preview" id="invoicePreview">
                                <div class="text-center mb-4">
                                    <h4 class="mb-0">WashCenter Pro</h4>
                                    <p class="text-muted small">Vehicle Washing & Care</p>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-6">
                                        <strong>Bill No:</strong> <span id="billNumber">-</span>
                                    </div>
                                    <div class="col-6 text-end">
                                        <strong>Date:</strong> <span id="billDate">-</span>
                                    </div>
                                </div>

                                <hr>

                                <div class="mb-3">
                                    <strong>Customer:</strong> <span id="previewCustomer">-</span><br>
                                    <strong>Mobile:</strong> <span id="previewMobile">-</span><br>
                                    <strong>Vehicle:</strong> <span id="previewVehicle">-</span>
                                </div>

                                <hr>

                                <h6>Services:</h6>
                                <div id="previewServices" class="mb-3">
                                    <p class="text-muted">No services selected</p>
                                </div>

                                <hr>

                                <div class="d-flex justify-content-between mb-3">
                                    <strong class="h5">Total Amount:</strong>
                                    <strong class="h5 text-primary">₹<span id="totalAmount">0</span></strong>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Payment Mode</label>
                                    <select id="paymentMode" class="form-select">
                                        <option value="Cash">Cash</option>
                                        <option value="UPI">UPI</option>
                                        <option value="Card">Card</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Employee</label>
                                    <select id="employeeSelect" class="form-select">
                                        <option value="">Select Employee</option>
                                    </select>
                                </div>

                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary btn-lg" onclick="saveBill()">
                                        <i class="fas fa-save me-2"></i>Save Bill
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="printBill()">
                                        <i class="fas fa-print me-2"></i>Print / Download PDF
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Page -->
        <div id="reports" class="page-section">
            <div class="row">
                <div class="col-12">
                    <h2 class="mb-4"><i class="fas fa-chart-bar me-2"></i>Reports</h2>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <i class="fas fa-filter me-2"></i>Filter Reports
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label">From Date</label>
                            <input type="date" id="fromDate" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">To Date</label>
                            <input type="date" id="toDate" class="form-control">
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-primary w-100" onclick="loadReports()">
                                <i class="fas fa-search me-2"></i>Generate Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <i class="fas fa-table me-2"></i>Bills Summary
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Bill No</th>
                                    <th>Date</th>
                                    <th>Vehicle</th>
                                    <th>Customer</th>
                                    <th>Services</th>
                                    <th>Amount</th>
                                    <th>Employee</th>
                                </tr>
                            </thead>
                            <tbody id="reportsTable">
                                <tr>
                                    <td colspan="7" class="text-center text-muted">Select date range and click Generate Report</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Employees Page -->
        <div id="employees" class="page-section">
            <div class="row">
                <div class="col-12">
                    <h2 class="mb-4"><i class="fas fa-users me-2"></i>Employee Management</h2>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-user-plus me-2"></i>Add New Employee
                        </div>
                        <div class="card-body">
                            <form id="employeeForm">
                                <div class="mb-3">
                                    <label class="form-label">Employee Name</label>
                                    <input type="text" id="empName" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Mobile Number</label>
                                    <input type="tel" id="empMobile" class="form-control" pattern="[0-9]{10}" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Designation</label>
                                    <input type="text" id="empDesignation" class="form-control" placeholder="e.g., Washer, Manager" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Status</label>
                                    <select id="empStatus" class="form-select">
                                        <option value="Active">Active</option>
                                        <option value="Inactive">Inactive</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-save me-2"></i>Save Employee
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-list me-2"></i>Employee List
                        </div>
                        <div class="card-body">
                            <div id="employeesList">
                                <p class="text-muted">No employees added yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // In-memory storage (simulating backend)
        let appData = {
            services: [
                { id: 1, name: 'Basic Wash', price: 200 },
                { id: 2, name: 'Premium Wash', price: 400 },
                { id: 3, name: 'Interior Cleaning', price: 300 },
                { id: 4, name: 'Wax Polish', price: 500 },
                { id: 5, name: 'Engine Wash', price: 250 }
            ],
            employees: [
                { id: 1, name: 'Rajesh Kumar', mobile: '9876543210', designation: 'Senior Washer', status: 'Active' },
                { id: 2, name: 'Amit Singh', mobile: '9876543211', designation: 'Washer', status: 'Active' }
            ],
            customers: [],
            bills: [],
            nextBillNo: 1001
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadServices();
            loadEmployees();
            updateDashboard();
            setDefaultDates();
            
            // Set current bill number and date
            document.getElementById('billNumber').textContent = appData.nextBillNo;
            document.getElementById('billDate').textContent = new Date().toLocaleDateString();
        });

        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (pageId === 'dashboard') {
                updateDashboard();
            } else if (pageId === 'newbill') {
                resetBillForm();
            }
        }

        // Vehicle Search
        function searchVehicle() {
            const vehicleNum = document.getElementById('vehicleNumber').value.toUpperCase().trim();
            
            if (!vehicleNum) {
                alert('Please enter vehicle number');
                return;
            }

            // Simulate API call
            const customer = appData.customers.find(c => c.vehicleNumber === vehicleNum);
            
            if (customer) {
                // Auto-fill customer details
                document.getElementById('customerName').value = customer.name;
                document.getElementById('mobileNumber').value = customer.mobile;
                document.getElementById('vehicleNumberDisplay').value = customer.vehicleNumber;
                document.getElementById('vehicleType').value = customer.vehicleType;
                
                // Update preview
                document.getElementById('previewCustomer').textContent = customer.name;
                document.getElementById('previewMobile').textContent = customer.mobile;
                document.getElementById('previewVehicle').textContent = customer.vehicleNumber + ' (' + customer.vehicleType + ')';
                
                alert('Customer found! Details auto-filled.');
            } else {
                // New customer - clear and enable form
                document.getElementById('vehicleNumberDisplay').value = vehicleNum;
                document.getElementById('customerName').value = '';
                document.getElementById('mobileNumber').value = '';
                document.getElementById('vehicleType').value = '';
                
                alert('New customer! Please fill in the details.');
            }
        }

        // Load Services
        function loadServices() {
            const container = document.getElementById('servicesList');
            container.innerHTML = '';
            
            appData.services.forEach(service => {
                const div = document.createElement('div');
                div.className = 'service-item';
                div.innerHTML = `
                    <div class="form-check d-flex justify-content-between align-items-center">
                        <div>
                            <input class="form-check-input" type="checkbox" value="${service.id}" 
                                id="service${service.id}" onchange="updateBillPreview()">
                            <label class="form-check-label" for="service${service.id}">
                                ${service.name}
                            </label>
                        </div>
                        <span class="badge bg-primary">₹${service.price}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Add Custom Service
        function addCustomService() {
            const name = document.getElementById('customServiceName').value.trim();
            const price = parseInt(document.getElementById('customServicePrice').value);
            
            if (!name || !price) {
                alert('Please enter service name and price');
                return;
            }
            
            const newService = {
                id: Date.now(),
                name: name,
                price: price,
                custom: true
            };
            
            appData.services.push(newService);
            loadServices();
            
            document.getElementById('customServiceName').value = '';
            document.getElementById('customServicePrice').value = '';
        }

        // Update Bill Preview
        function updateBillPreview() {
            let selectedServices = [];
            let total = 0;
            
            appData.services.forEach(service => {
                const checkbox = document.getElementById('service' + service.id);
                if (checkbox && checkbox.checked) {
                    selectedServices.push(service);
                    total += service.price;
                }
            });
            
            const servicesDiv = document.getElementById('previewServices');
            if (selectedServices.length > 0) {
                servicesDiv.innerHTML = selectedServices.map(s => `
                    <div class="d-flex justify-content-between mb-2">
                        <span>${s.name}</span>
                        <span>₹${s.price}</span>
                    </div>
                `).join('');
            } else {
                servicesDiv.innerHTML = '<p class="text-muted">No services selected</p>';
            }
            
            document.getElementById('totalAmount').textContent = total;
        }

        // Save Bill
        function saveBill() {
            const customerName = document.getElementById('customerName').value.trim();
            const mobile = document.getElementById('mobileNumber').value.trim();
            const vehicleNum = document.getElementById('vehicleNumberDisplay').value.trim();
            const vehicleType = document.getElementById('vehicleType').value;
            const paymentMode = document.getElementById('paymentMode').value;
            const employeeId = document.getElementById('employeeSelect').value;
            
            if (!customerName || !mobile || !vehicleNum || !vehicleType) {
                alert('Please fill in all customer details');
                return;
            }
            
            if (!employeeId) {
                alert('Please select an employee');
                return;
            }
            
            let selectedServices = [];
            appData.services.forEach(service => {
                const checkbox = document.getElementById('service' + service.id);
                if (checkbox && checkbox.checked) {
                    selectedServices.push(service);
                }
            });
            
            if (selectedServices.length === 0) {
                alert('Please select at least one service');
                return;
            }
            
            const total = selectedServices.reduce((sum, s) => sum + s.price, 0);
            
            // Save customer if new
            if (!appData.customers.find(c => c.vehicleNumber === vehicleNum)) {
                appData.customers.push({
                    name: customerName,
                    mobile: mobile,
                    vehicleNumber: vehicleNum,
                    vehicleType: vehicleType
                });
            }
            
            // Save bill
            const bill = {
                billNo: appData.nextBillNo++,
                date: new Date().toISOString(),
                customer: customerName,
                mobile: mobile,
                vehicleNumber: vehicleNum,
                vehicleType: vehicleType,
                services: selectedServices,
                total: total,
                paymentMode: paymentMode,
                employeeId: employeeId,
                employeeName: appData.employees.find(e => e.id == employeeId).name
            };
            
            appData.bills.push(bill);
            
            alert('Bill saved successfully! Bill No: ' + bill.billNo);
            resetBillForm();
            updateDashboard();
        }

        // Print Bill
        function printBill() {
            const customerName = document.getElementById('customerName').value.trim();
            if (!customerName) {
                alert('Please fill in customer details and select services first');
                return;
            }
            
            window.print();
        }

        // Reset Bill Form
        function resetBillForm() {
            document.getElementById('vehicleNumber').value = '';
            document.getElementById('customerForm').reset();
            document.getElementById('vehicleNumberDisplay').value = '';
            
            // Uncheck all services
            appData.services.forEach(service => {
                const checkbox = document.getElementById('service' + service.id);
                if (checkbox) checkbox.checked = false;
            });
            
            document.getElementById('billNumber').textContent = appData.nextBillNo;
            document.getElementById('billDate').textContent = new Date().toLocaleDateString();
            document.getElementById('previewCustomer').textContent = '-';
            document.getElementById('previewMobile').textContent = '-';
            document.getElementById('previewVehicle').textContent = '-';
            document.getElementById('previewServices').innerHTML = '<p class="text-muted">No services selected</p>';
            document.getElementById('totalAmount').textContent = '0';
            document.getElementById('paymentMode').value = 'Cash';
            document.getElementById('employeeSelect').value = '';
        }

        // Load Employees
        function loadEmployees() {
            const select = document.getElementById('employeeSelect');
            select.innerHTML = '<option value="">Select Employee</option>';
            
            appData.employees.filter(e => e.status === 'Active').forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                select.appendChild(option);
            });
            
            displayEmployeesList();
        }

        // Display Employees List
        function displayEmployeesList() {
            const container = document.getElementById('employeesList');
            
            if (appData.employees.length === 0) {
                container.innerHTML = '<p class="text-muted">No employees added yet</p>';
                return;
            }
            
            container.innerHTML = appData.employees.map(emp => `
                <div class="employee-card">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1">${emp.name}</h6>
                            <p class="text-muted small mb-1">
                                <i class="fas fa-phone me-1"></i>${emp.mobile}
                            </p>
                            <p class="text-muted small mb-0">
                                <i class="fas fa-briefcase me-1"></i>${emp.designation}
                            </p>
                        </div>
                        <span class="badge badge-custom ${emp.status === 'Active' ? 'bg-success' : 'bg-secondary'}">
                            ${emp.status}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        // Add Employee
        document.getElementById('employeeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('empName').value.trim();
            const mobile = document.getElementById('empMobile').value.trim();
            const designation = document.getElementById('empDesignation').value.trim();
            const status = document.getElementById('empStatus').value;
            
            const newEmployee = {
                id: Date.now(),
                name: name,
                mobile: mobile,
                designation: designation,
                status: status
            };
            
            appData.employees.push(newEmployee);
            loadEmployees();
            
            this.reset();
            alert('Employee added successfully!');
        });

        // Update Dashboard
        function updateDashboard() {
            const today = new Date().toDateString();
            const todayBills = appData.bills.filter(b => new Date(b.date).toDateString() === today);
            
            document.getElementById('totalVehicles').textContent = todayBills.length;
            document.getElementById('totalEarnings').textContent = '₹' + todayBills.reduce((sum, b) => sum + b.total, 0);
            
            let totalServicesCount = 0;
            todayBills.forEach(b => totalServicesCount += b.services.length);
            document.getElementById('totalServices').textContent = totalServicesCount;
            
            document.getElementById('activeEmployees').textContent = appData.employees.filter(e => e.status === 'Active').length;
            
            // Service-wise stats
            const serviceStats = {};
            todayBills.forEach(bill => {
                bill.services.forEach(service => {
                    if (!serviceStats[service.name]) {
                        serviceStats[service.name] = { count: 0, revenue: 0 };
                    }
                    serviceStats[service.name].count++;
                    serviceStats[service.name].revenue += service.price;
                });
            });
            
            const statsTable = document.getElementById('serviceStatsTable');
            if (Object.keys(serviceStats).length > 0) {
                statsTable.innerHTML = Object.entries(serviceStats).map(([name, data]) => `
                    <tr>
                        <td>${name}</td>
                        <td><span class="badge bg-primary">${data.count}</span></td>
                        <td>₹${data.revenue}</td>
                    </tr>
                `).join('');
            } else {
                statsTable.innerHTML = '<tr><td colspan="3" class="text-center text-muted">No data available</td></tr>';
            }
            
            // Recent activities
            const recentDiv = document.getElementById('recentActivities');
            if (todayBills.length > 0) {
                const recent = todayBills.slice(-5).reverse();
                recentDiv.innerHTML = recent.map(bill => `
                    <div class="mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <strong>${bill.vehicleNumber}</strong>
                                <p class="text-muted small mb-0">${bill.customer}</p>
                                <p class="text-muted small mb-0">₹${bill.total}</p>
                            </div>
                            <span class="badge bg-success">${new Date(bill.date).toLocaleTimeString()}</span>
                        </div>
                    </div>
                `).join('');
            } else {
                recentDiv.innerHTML = '<p class="text-muted">No recent activities</p>';
            }
        }

        // Set Default Dates for Reports
        function setDefaultDates() {
            const today = new Date();
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
            
            document.getElementById('fromDate').valueAsDate = firstDay;
            document.getElementById('toDate').valueAsDate = today;
        }

        // Load Reports
        function loadReports() {
            const fromDate = new Date(document.getElementById('fromDate').value);
            const toDate = new Date(document.getElementById('toDate').value);
            
            if (!document.getElementById('fromDate').value || !document.getElementById('toDate').value) {
                alert('Please select both dates');
                return;
            }
            
            toDate.setHours(23, 59, 59, 999);
            
            const filteredBills = appData.bills.filter(bill => {
                const billDate = new Date(bill.date);
                return billDate >= fromDate && billDate <= toDate;
            });
            
            const table = document.getElementById('reportsTable');
            if (filteredBills.length > 0) {
                table.innerHTML = filteredBills.map(bill => `
                    <tr>
                        <td><strong>${bill.billNo}</strong></td>
                        <td>${new Date(bill.date).toLocaleDateString()}</td>
                        <td>${bill.vehicleNumber}</td>
                        <td>${bill.customer}<br><small class="text-muted">${bill.mobile}</small></td>
                        <td>
                            ${bill.services.map(s => `<span class="badge bg-light text-dark me-1">${s.name}</span>`).join('')}
                        </td>
                        <td><strong>₹${bill.total}</strong></td>
                        <td>${bill.employeeName}</td>
                    </tr>
                `).join('');
            } else {
                table.innerHTML = '<tr><td colspan="7" class="text-center text-muted">No bills found for selected date range</td></tr>';
            }
        }

        // Print styles
        const style = document.createElement('style');
        style.textContent = `
            @media print {
                body * { visibility: hidden; }
                #invoicePreview, #invoicePreview * { visibility: visible; }
                #invoicePreview { 
                    position: absolute; 
                    left: 0; 
                    top: 0; 
                    width: 100%;
                    padding: 20px;
                }
                .btn { display: none !important; }
                nav { display: none !important; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
